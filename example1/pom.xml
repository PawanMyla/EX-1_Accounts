import java.util.*;

public class Main {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        // --- Input all details in a single line ---
        System.out.println("Enter details in the following format:");
        System.out.println("customerNumber,firstName,surname|primaryPhone,secondaryPhone,countryCode,phoneType;primaryPhone,secondaryPhone,countryCode,phoneType|accountNumber,balance,productCode,productModes,linkedAccounts;accountNumber,balance,productCode,productModes,linkedAccounts");

        String input = scanner.nextLine();

        // --- Parsing the input ---
        String[] sections = input.split("\\|");

        // Customer details: customerNumber,firstName,surname
        String[] customerDetails = sections[0].split(",");
        String customerNumber = customerDetails[0];
        String firstName = customerDetails[1];
        String surname = customerDetails[2];

        // Phone details: primaryPhone,secondaryPhone,countryCode,phoneType; (multiple phones separated by ;)
        String[] phoneDetailsInput = sections[1].split(";");
        List<PhoneDetails> phoneDetailsList = new ArrayList<>();
        for (String phoneStr : phoneDetailsInput) {
            String[] phoneData = phoneStr.split(",");
            PhoneDetails phoneDetails = new PhoneDetails(phoneData[0], phoneData[1], phoneData[2].isEmpty() ? null : phoneData[2], phoneData[3]);
            phoneDetailsList.add(phoneDetails);
        }

        // Account details: accountNumber,balance,productCode,productModes,linkedAccounts; (multiple accounts separated by ;)
        String[] accountDetailsInput = sections[2].split(";");
        List<Account> accountList = new ArrayList<>();
        for (String accountStr : accountDetailsInput) {
            String[] accountData = accountStr.split(",");
            String accountNumber = accountData[0];
            double balance = Double.parseDouble(accountData[1]);
            String productCode = accountData[2];
            List<String> productModes = Arrays.asList(accountData[3].split("/"));
            List<String> linkedAccounts = Arrays.asList(accountData[4].split("/"));
            Account account = new Account(accountNumber, balance, productCode, productModes, linkedAccounts);
            accountList.add(account);
        }

        // --- Create Customer object ---
        Customer customer = new Customer(customerNumber, firstName, surname, phoneDetailsList);

        // --- Output Customer Information ---
        System.out.println("\nCustomer Information:");
        System.out.println("Customer Number: " + customer.getCustomerNumber());
        System.out.println("Full Name: " + customer.getFullName());

        // --- Print all phone details ---
        for (PhoneDetails phone : phoneDetailsList) {
            System.out.println(phone.getPhoneType() + " Phone: " + phone.getPrimaryNumber() + ", Secondary: " + phone.getSecondaryNumber());
        }

        // --- Manually process linked account numbers ---
        List<String> linkedAccountNumbers = new ArrayList<>();
        for (Account account : accountList) {
            linkedAccountNumbers.addAll(account.getLinkedAccountNumbers());
        }
        System.out.println("Linked Account Numbers: " + linkedAccountNumbers);

        // --- Manually process product mode lists ---
        List<String> allProductModes = new ArrayList<>();
        for (Account account : accountList) {
            allProductModes.addAll(account.getProductModeList());
        }
        System.out.println("Product Mode List: " + allProductModes);

        // --- Print current balance for each account ---
        for (Account account : accountList) {
            System.out.println("Account Number: " + account.getAccountNumber() + ", Current Balance: " + account.getCurrentBalance());
        }

        scanner.close();
    }
}
